# LLM Temperature 설정 근거

## 현재 설정

### Stream Mode (10개 세그먼트 생성)
- **Temperature: 0.0** (구조 준수 최우선)
- **이유**: 
  - 생체 데이터 기반이므로 창의도 불필요
  - 정확한 구조 준수가 가장 중요
  - 일관된 출력 형식 필요

## Temperature 값별 특성

### 0.0 (Deterministic)
- **장점**:
  - 가장 일관된 응답
  - 구조 준수율 최고
  - 환각(hallucination) 최소화
  - 동일 입력에 대해 동일 출력
- **단점**:
  - 완전히 기계적인 응답 가능
  - 약간의 다양성 부족
- **적합한 경우**:
  - ✅ 구조화된 출력이 필수인 경우
  - ✅ 데이터 기반 결정이 필요한 경우
  - ✅ 일관성이 가장 중요한 경우

### 0.1-0.3 (Low Creativity)
- **장점**:
  - 구조 준수 + 약간의 다양성
  - 여전히 높은 일관성
- **단점**:
  - 여전히 구조 위반 가능성 존재
- **적합한 경우**:
  - 구조 준수 + 약간의 표현 다양성 필요

### 0.7 (Medium Creativity) - 이전 설정
- **장점**:
  - 창의적인 표현
  - 다양한 응답
- **단점**:
  - 구조 위반 가능성 높음
  - 환각 가능성 증가
- **적합한 경우**:
  - 창의성이 중요한 경우 (예: 무드 이름 생성)
  - ❌ 구조화된 출력이 필요한 경우에는 부적합

## 우리 시스템의 특성

### 왜 Temperature 0.0이 적합한가?

1. **생체 데이터 기반 결정**
   - 사용자의 실제 생체 데이터(심박수, HRV, 스트레스 등)를 기반으로 결정
   - 창의성이 아닌 데이터 기반 논리적 결정이 필요

2. **구조 준수가 최우선**
   - CompleteSegmentOutput 구조를 정확히 준수해야 함
   - 구조 위반 시 시스템 오류 발생 가능

3. **일관성 필요**
   - 동일한 생체 데이터 → 동일한 출력 구조
   - 사용자 경험의 일관성 보장

4. **환각 방지**
   - 존재하지 않는 음악 선택
   - 잘못된 필드명 사용
   - 누락된 필드

## 다른 Handler와의 비교

### musicHandler.ts / scentHandler.ts
- **Temperature: 0.7** (유지)
- **이유**: 단일 세그먼트, 무드 이름 등 창의적 표현 필요

### LLMEmotionPredictionProvider.ts
- **Temperature: 0.3** (유지)
- **이유**: 감정 예측은 약간의 다양성 허용

## 결론

**Stream Mode의 Temperature 0.0 설정은 올바른 선택입니다.**

- 생체 데이터 기반 결정이므로 창의도 불필요
- 구조 준수가 가장 중요
- 일관성과 정확성 우선
- 환각 방지

만약 구조 준수 문제가 계속 발생한다면:
1. ✅ Temperature는 이미 최적 (0.0)
2. ✅ 프롬프트 강화 필요
3. ✅ 시스템 메시지 강화 필요
4. ✅ 예제 명확화 필요

