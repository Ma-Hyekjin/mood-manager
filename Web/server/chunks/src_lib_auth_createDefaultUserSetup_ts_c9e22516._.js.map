{"version":3,"sources":["turbopack:///[project]/src/lib/auth/createDefaultUserSetup.ts"],"sourcesContent":["// src/lib/auth/createDefaultUserSetup.ts\n/**\n * 신규 사용자 기본 설정 생성\n * \n * 사용자 생성 시 자동으로:\n * 1. 기본 Preset 컴포넌트 생성 (Fragrance, Light, Sound)\n * 2. 기본 Preset 생성\n * 3. 기본 Manager 디바이스 생성\n */\n\nimport { prisma } from \"@/lib/prisma\";\n\n/**\n * 기본 Preset 컴포넌트 생성\n * 각 사용자마다 고유한 컴포넌트를 생성\n */\nasync function createDefaultPresetComponents() {\n  // 기본 Fragrance 생성\n  const defaultFragrance = await prisma.fragrance.create({\n    data: {\n      name: \"Lavender\",\n      description: \"차분하고 평온한 라벤더 향\",\n      color: \"#E6E6FA\",\n      intensityLevel: 5,\n      operatingMin: 30,\n      componentsJson: {\n        type: \"floral\",\n        intensity: 5,\n      },\n    },\n  });\n\n  // 기본 Light 생성\n  const defaultLight = await prisma.light.create({\n    data: {\n      name: \"Warm White\",\n      color: \"#FFD966\",\n      brightness: 80,\n    },\n  });\n\n  // 기본 Sound 생성\n  const defaultSound = await prisma.sound.create({\n    data: {\n      name: \"Calm Breeze\",\n      fileUrl: \"/sounds/calm-breeze.mp3\",\n      duration: 180,\n      componentsJson: {\n        genre: \"newage\",\n        mood: \"calm\",\n      },\n    },\n  });\n\n  return { defaultFragrance, defaultLight, defaultSound };\n}\n\n/**\n * 신규 사용자 기본 설정 생성\n */\nexport async function createDefaultUserSetup(userId: string) {\n  try {\n    // 1. 기본 Preset 컴포넌트 생성\n    const { defaultFragrance, defaultLight, defaultSound } = await createDefaultPresetComponents();\n\n    // 2. 기본 Preset 생성\n    const defaultPreset = await prisma.preset.create({\n      data: {\n        userId,\n        fragranceId: defaultFragrance.id,\n        lightId: defaultLight.id,\n        soundId: defaultSound.id,\n        name: \"Calm Breeze\",\n        cluster: \"0\", // 중립\n        isDefault: true,\n      },\n    });\n\n    // 3. 기본 Manager 디바이스 생성\n    const managerDevice = await prisma.device.create({\n      data: {\n        userId,\n        name: \"Mood Manager\",\n        type: \"manager\",\n        status: \"active\",\n        battery: 100,\n        power: true,\n        brightness: 80,\n        color: defaultLight.color,\n        scentType: defaultFragrance.name,\n        scentLevel: 7,\n        scentInterval: 30,\n        volume: 65,\n        nowPlaying: defaultSound.name,\n        currentPresetId: defaultPreset.id,\n      },\n    });\n\n    console.log(\"[createDefaultUserSetup] 기본 설정 생성 완료:\", {\n      userId,\n      presetId: defaultPreset.id,\n      deviceId: managerDevice.id,\n    });\n\n    return {\n      preset: defaultPreset,\n      device: managerDevice,\n    };\n  } catch (error) {\n    console.error(\"[createDefaultUserSetup] 기본 설정 생성 실패:\", error);\n    throw error;\n  }\n}\n\n"],"names":[],"mappings":"uCAQC,EAAA,CAAA,CAAA,kCAED,IAAA,EAAA,EAAA,CAAA,CAAA,OAMA,eAAe,IAEb,IAAM,EAAmB,MAAM,EAAA,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CACrD,KAAM,CACJ,KAAM,WACN,YAAa,iBACb,MAAO,UACP,eAAgB,EAChB,aAAc,GACd,eAAgB,CACd,KAAM,SACN,UAAW,CACb,CACF,CACF,GAwBA,MAAO,CAAE,mBAAkB,aArBN,MAAM,EAAA,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAC7C,KAAM,CACJ,KAAM,aACN,MAAO,UACP,WAAY,EACd,CACF,GAeyC,aAZpB,MAAM,EAAA,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,CAC7C,KAAM,CACJ,KAAM,cACN,QAAS,0BACT,SAAU,IACV,eAAgB,CACd,MAAO,SACP,KAAM,MACR,CACF,CACF,EAEsD,CACxD,CAKO,eAAe,EAAuB,CAAc,EACzD,GAAI,CAEF,GAAM,kBAAE,CAAgB,cAAE,CAAY,cAAE,CAAY,CAAE,CAAG,MAAM,IAGzD,EAAgB,MAAM,EAAA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAC/C,KAAM,QACJ,EACA,YAAa,EAAiB,EAAE,CAChC,QAAS,EAAa,EAAE,CACxB,QAAS,EAAa,EAAE,CACxB,KAAM,cACN,QAAS,IACT,WAAW,CACb,CACF,GAGM,EAAgB,MAAM,EAAA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAC/C,KAAM,QACJ,EACA,KAAM,eACN,KAAM,UACN,OAAQ,SACR,QAAS,IACT,OAAO,EACP,WAAY,GACZ,MAAO,EAAa,KAAK,CACzB,UAAW,EAAiB,IAAI,CAChC,WAAY,EACZ,cAAe,GACf,OAAQ,GACR,WAAY,EAAa,IAAI,CAC7B,gBAAiB,EAAc,EAAE,AACnC,CACF,GAQA,OANA,QAAQ,GAAG,CAAC,wCAAyC,CACnD,SACA,SAAU,EAAc,EAAE,CAC1B,SAAU,EAAc,EAAE,AAC5B,GAEO,CACL,OAAQ,EACR,OAAQ,CACV,CACF,CAAE,MAAO,EAAO,CAEd,MADA,QAAQ,KAAK,CAAC,wCAAyC,GACjD,CACR,CACF"}