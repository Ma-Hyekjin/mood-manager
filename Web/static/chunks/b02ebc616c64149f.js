(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,388,e=>{"use strict";e.s(["default",()=>f],388);var t=e.i(43476),a=e.i(71645),r=e.i(18566),l=e.i(17255),i=e.i(22016),s=e.i(63488),n=e.i(70756),o=e.i(86536),c=e.i(77705),d=e.i(40141);function u(e){return(0,d.GenIcon)({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r\n	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r\n	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r\n	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r\n	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"},child:[]},{tag:"path",attr:{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r\n	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"},child:[]}]})(e)}function m(e){return(0,d.GenIcon)({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3.0743 10.4403l.655.4728-1.6101 2.0192 1.8647 2.2373-.646.5004-2.201-2.6924zm-2.2376 5.102H0V8.5121l.8367-.182zm20.944-4.3837c-.4364 0-.7715.1637-1.0049.4912-.2338.3274-.3505.8064-.3505 1.437 0 .6247.1167 1.096.3505 1.4143.2334.3183.5685.4775 1.0049.4775.4423 0 .7804-.1593 1.0143-.4775.2332-.3182.35-.7896.35-1.4142 0-.6307-.1168-1.1097-.35-1.4371-.234-.3275-.572-.4912-1.0143-.4912m0-.673c.691 0 1.234.2245 1.6277.673.3944.4488.5916 1.0915.5916 1.9283 0 .8244-.1955 1.4583-.5868 1.901-.3909.4422-.9356.6637-1.6325.6637-.691 0-1.234-.2215-1.6277-.6638-.3944-.4426-.5916-1.0765-.5916-1.901 0-.8367.1984-1.4794.5957-1.9282.3973-.4485.9385-.673 1.6236-.673m-5.534 4.4658a1.496 1.496 0 0 0 .3576-.0456 2.8804 2.8804 0 0 0 .3713-.1181 2.0066 2.0066 0 0 0 .3488-.1774 2.0778 2.0778 0 0 0 .2895-.2229v-1.1641h-.8693c-.441 0-.7626.0758-.9645.2274-.2025.1516-.3031.391-.3031.7185 0 .5214.2563.7822.7697.7822m-1.5704-.7458c0-.5032.1682-.887.5045-1.1504.337-.2638.826-.396 1.4691-.396h.964v-.3182c0-.77-.3393-1.155-1.0185-1.155-.2184 0-.447.0304-.6869.091-.2398.0608-.4594.1365-.659.2274l-.2457-.5913c.2487-.1394.517-.2469.8047-.323.2878-.0754.5685-.1136.8414-.1136 1.176 0 1.7646.6276 1.7646 1.8826v3.1833h-.6188l-.1-.5457c-.2488.2001-.5134.3547-.796.464-.2817.1092-.55.1637-.8046.1637-.4429 0-.7899-.1258-1.0416-.3775-.2515-.2517-.3772-.5987-.3772-1.0413m-1.6508-3.7653l.655.4728-1.6095 2.0192 1.864 2.2373-.6454.5004-2.201-2.6924zm-2.237 5.102h-.8367V8.5121l.8368-.182zm-4.4936-.5909c.1148 0 .2339-.0151.3576-.0456a2.8794 2.8794 0 0 0 .3713-.1181 1.9842 1.9842 0 0 0 .3488-.1774 2.0477 2.0477 0 0 0 .29-.2229v-1.1641h-.8698c-.4404 0-.762.0758-.9645.2274-.202.1516-.3031.391-.3031.7185 0 .5214.2563.7822.7697.7822m-1.5704-.7458c0-.5032.1682-.887.5052-1.1504.3363-.2638.826-.396 1.4684-.396h.9646v-.3182c0-.77-.3399-1.155-1.019-1.155-.218 0-.4471.0304-.6863.091-.2398.0608-.4595.1365-.6597.2274l-.2457-.5913c.2487-.1394.517-.2469.8053-.323.2878-.0754.5684-.1136.8408-.1136 1.1766 0 1.7646.6276 1.7646 1.8826v3.1833h-.6182l-.1001-.5457c-.2487.2001-.514.3547-.7958.464-.282.1092-.5501.1637-.8053.1637-.4423 0-.7893-.1258-1.041-.3775-.2516-.2517-.3778-.5987-.3778-1.0413Z"},child:[]}]})(e)}function g(e){return(0,d.GenIcon)({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16.273 12.845 7.376 0H0v24h7.726V11.156L16.624 24H24V0h-7.727v12.845Z"},child:[]}]})(e)}var h=e.i(5766);function f(){let e=(0,r.useRouter)(),{status:d}=(0,l.useSession)();(0,a.useEffect)(()=>{"authenticated"===d&&e.replace("/home")},[d,e]);let[f,x]=(0,a.useState)(""),[p,y]=(0,a.useState)(""),[b,v]=(0,a.useState)(!1),[w,N]=(0,a.useState)(""),[j,C]=(0,a.useState)(!1),[S,k]=(0,a.useState)(0),[z,D]=(0,a.useState)(!1),[M,I]=(0,a.useState)(null);(0,a.useEffect)(()=>{M&&(new Date>=M?(D(!1),I(null),k(0)):D(!0))},[M]);let L=async()=>{if(N(""),z&&M){let e=Math.ceil((M.getTime()-new Date().getTime())/6e4),t="Too many login attempts. Please try again in ".concat(e," minute(s).");N(t),h.default.error(t);return}if(!f||!p){let e="Please enter your email and password.";N(e),h.default.error(e);return}C(!0);try{let t=await (0,l.signIn)("credentials",{email:f,password:p,redirect:!1});if(null==t?void 0:t.error){let e=S+1;if(k(e),e>=5){let e=new Date;e.setMinutes(e.getMinutes()+15),I(e),D(!0);let t="Too many failed login attempts. Your account is locked for 15 minutes.";N(t),h.default.error(t),C(!1);return}let t="Invalid email or password. (".concat(e,"/5 attempts)");N(t),h.default.error("Invalid email or password."),C(!1);return}k(0),C(!1),h.default.success("Login successful!"),e.push("/home")}catch(t){console.error(t);let e="An unexpected error occurred. Please try again.";N(e),h.default.error(e),C(!1)}},P=async t=>{C(!0),N("");try{let a=await (0,l.signIn)(t,{redirect:!1});if(null==a?void 0:a.error){console.log("[Social Login] ".concat(t," login failed, redirecting to register")),h.default.error("Please sign up first."),e.push("/register?provider=".concat(t));return}if(null==a?void 0:a.ok){try{let a=await fetch("/api/auth/profile",{method:"GET",credentials:"include"});if(a.ok){let r=await a.json();if(!r.givenName||!r.familyName||!r.birthDate||!r.gender){console.log("[Social Login] Profile incomplete, redirecting to register"),console.log("[Social Login] Missing fields:",{givenName:!r.givenName,familyName:!r.familyName,birthDate:!r.birthDate,gender:!r.gender}),(0,h.default)("Please complete your profile.");let a=new URLSearchParams({provider:t,email:r.email||""});r.givenName&&a.append("name",r.givenName),r.familyName&&a.append("familyName",r.familyName),r.birthDate&&a.append("birthDate",r.birthDate),r.gender&&a.append("gender",r.gender),r.profileImageUrl&&a.append("image",r.profileImageUrl),e.push("/register?".concat(a.toString()));return}}}catch(e){console.error("[Social Login] Profile check error:",e)}h.default.success("Login successful!"),e.push("/home")}}catch(e){console.error("[Social Login] ".concat(t," error:"),e),h.default.error("An error occurred during social login.")}finally{C(!1)}};return(0,t.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center px-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold mb-8",children:"Mood Manager"}),(0,t.jsxs)("div",{className:"w-full max-w-sm space-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Email"}),(0,t.jsxs)("div",{className:"flex items-center px-3 py-2 border rounded-md",children:[(0,t.jsx)(s.Mail,{size:18,className:"text-gray-400 mr-2"}),(0,t.jsx)("input",{type:"email",placeholder:"name@example.com",className:"w-full outline-none",autoComplete:"email",onChange:e=>{x(e.target.value),N("")},onKeyDown:e=>{"Enter"!==e.key||j||z||L()}})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Password"}),(0,t.jsxs)("div",{className:"flex items-center px-3 py-2 border rounded-md relative",children:[(0,t.jsx)(n.Lock,{size:18,className:"text-gray-400 mr-2"}),(0,t.jsx)("input",{type:b?"text":"password",placeholder:"password",className:"w-full outline-none",autoComplete:"current-password",onChange:e=>{y(e.target.value),N("")},onKeyDown:e=>{"Enter"!==e.key||j||z||L()}}),(0,t.jsx)("button",{type:"button",className:"absolute right-3",onClick:()=>v(!b),children:b?(0,t.jsx)(c.EyeOff,{size:18,className:"text-gray-500"}):(0,t.jsx)(o.Eye,{size:18,className:"text-gray-500"})})]})]}),w&&(0,t.jsx)("p",{className:"text-red-500 text-sm",children:w}),(0,t.jsx)("button",{onClick:L,disabled:j||z,className:"w-full bg-black text-white h-12 rounded-lg font-medium active:bg-gray-700 transition disabled:opacity-50 disabled:cursor-not-allowed mt-6",children:j?"Signing in...":z?"Account Locked":"Sign In"}),(0,t.jsx)("button",{onClick:()=>e.push("/register"),className:"w-full bg-white text-black h-12 rounded-lg font-medium border active:bg-gray-200 transition",children:"Sign Up"}),(0,t.jsx)(i.default,{href:"/forgot-password",className:"text-sm text-gray-500 text-center block mt-1 hover:text-gray-700 transition underline",children:"Forgot password?"}),(0,t.jsxs)("div",{className:"flex items-center my-6",children:[(0,t.jsx)("div",{className:"flex-grow h-px bg-gray-300"}),(0,t.jsx)("span",{className:"px-3 text-sm text-gray-500",children:"Social Sign In"}),(0,t.jsx)("div",{className:"flex-grow h-px bg-gray-300"})]}),(0,t.jsxs)("div",{className:"flex justify-center space-x-6 mt-4",children:[(0,t.jsx)("button",{onClick:()=>P("google"),disabled:j,className:"w-12 h-12 rounded-full border flex items-center justify-center hover:bg-gray-100 transition disabled:opacity-50 disabled:cursor-not-allowed",children:(0,t.jsx)(u,{size:24})}),(0,t.jsx)("button",{onClick:()=>P("kakao"),disabled:j,className:"w-12 h-12 rounded-full border flex items-center justify-center hover:bg-gray-100 transition disabled:opacity-50 disabled:cursor-not-allowed",children:(0,t.jsx)(m,{size:22,color:"#FEE500"})}),(0,t.jsx)("button",{onClick:()=>P("naver"),disabled:j,className:"w-12 h-12 rounded-full border flex items-center justify-center hover:bg-gray-100 transition disabled:opacity-50 disabled:cursor-not-allowed",children:(0,t.jsx)(g,{size:22,color:"#03C75A"})})]})]})]})}}]);